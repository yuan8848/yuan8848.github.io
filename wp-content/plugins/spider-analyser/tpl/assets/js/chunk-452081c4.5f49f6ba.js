(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-452081c4"],{"498a":function(t,e,i){"use strict";var a=i("23e7"),s=i("58a8").trim,n=i("c8d2");a({target:"String",proto:!0,forced:n("trim")},{trim:function(){return s(this)}})},c8d2:function(t,e,i){var a=i("d039"),s=i("5899"),n="​᠎";t.exports=function(t){return a((function(){return!!s[t]()||n[t]()!=n||s[t].name!==t}))}},f2b9:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wbs-content"},[i("div",{staticClass:"wbs-main"},[i("div",{staticClass:"table-wp"},[t.isLoaded?i("table",{staticClass:"wbs-table table-border table-rule-type"},[t._m(0),i("tbody",[t._l(t.spider.url_type,(function(e,a){return i("tr",[i("td",[t._v(t._s(e))]),i("td",[t.url_type_editing==a?i("wbs-tags-module",{attrs:{tags:t.opt.extral_rule[a],placeholder:"输入规则，按回车确认"},on:{"set-tags":function(e){t.opt.extral_rule[a]=e}}}):i("div",{staticClass:"display-rule"},[i("span",{staticClass:"wb-status-tag rule"},[t._v("默认WP规则")]),t._l(t.opt.extral_rule[a].split(","),(function(e){return t.opt.extral_rule[a]?i("span",{staticClass:"wb-status-tag rule"},[t._v(t._s(e))]):t._e()}))],2)],1),i("td",{staticClass:"align-center"},[t.url_type_editing!=a?i("a",{staticClass:"link",attrs:{title:"编辑"},on:{click:function(e){t.url_type_editing=a}}},[i("svg",{staticClass:"wb-icon sico-edit"},[i("use",{attrs:{"xlink:href":"#sico-edit"}})])]):t._e(),t.url_type_editing==a?i("a",{staticClass:"link",on:{click:function(e){t.url_type_editing=-1}}},[t._v("完成编辑")]):t._e()])])})),t._l(t.opt.user_rule,(function(e,a){return i("tr",{class:{"cur-editing":t.url_type_editing==a}},[i("td",[t.url_type_editing==a?i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"v.name"}],staticClass:"wbs-input",attrs:{placeholder:"输入url类型"},domProps:{value:e.name},on:{input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}}):i("span",{staticClass:"display-value"},[t._v(t._s(e.name))])]),i("td",[t.url_type_editing==a?i("wbs-tags-module",{attrs:{tags:e.rule,placeholder:"输入规则，按回车确认"},on:{"set-tags":function(t){e.rule=t}}}):i("div",{staticClass:"display-rule"},t._l(e.rule.split(","),(function(a){return e.rule?i("span",{staticClass:"wb-status-tag rule"},[t._v(t._s(a))]):t._e()})),0)],1),i("td",{staticClass:"align-center"},[t.url_type_editing!=a?i("a",{staticClass:"link",attrs:{title:"编辑"},on:{click:function(e){t.url_type_editing=a}}},[i("svg",{staticClass:"wb-icon sico-edit"},[i("use",{attrs:{"xlink:href":"#sico-edit"}})])]):t._e(),t.url_type_editing==a?i("div",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.saveRuleItem(e)}}},[t._v("完成")]),i("a",{staticClass:"button-link-delete ml",attrs:{title:"取消"},on:{click:function(e){return t.removeRule(a)}}},[t._v("取消")])],1):t._e(),t.url_type_editing!=a?i("a",{staticClass:"button-link-delete",attrs:{title:"删除"},on:{click:function(e){return t.removeRule(a)}}},[i("svg",{staticClass:"wb-icon sico-del"},[i("use",{attrs:{"xlink:href":"#sico-del"}})])]):t._e()])])}))],2),i("tfoot",[i("tr",[i("td"),i("td"),i("td",[i("el-button",{attrs:{plain:"",type:"primary",size:"mini",icon:"el-icon-circle-plus"},on:{click:t.addRule}},[t._v("添加定义")])],1)])])]):t._e()]),t._m(1)]),t.$cnf.is_pro?t._e():i("wbs-more-sources"),i("wbs-ctrl-bar",{on:{submit:t.update_data}})],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",{staticClass:"w30"},[t._v("类型")]),i("th",[t._v("规则")]),i("th",{staticClass:"w8em align-center"},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dl",{staticClass:"description mt"},[i("dt",[t._v("温馨提示：")]),i("dd",[t._v("支持通配符形式链接规则，如"),i("code",[t._v("/mp-api/*")])]),i("dd",[t._v("如有不同于预设的链接类型，可以通过添加自定义来新增；否则建议在预设类型基础上修改新增。")])])}],n=(i("a434"),i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{staticClass:"wb-tags-ctrl"},[i("div",{staticClass:"tag-items"},t._l(t.taglist,(function(e,a){return t.taglist.length?i("div",{staticClass:"tag-item"},[i("span",{staticClass:"vam ib",domProps:{innerHTML:t._s(t.displayFormat(e))}}),i("a",{staticClass:"del",attrs:{"data-del-val":e},on:{click:function(e){return t.delItem(a)}}})]):t._e()})),0),i("input",{directives:[{name:"model",rawName:"v-model",value:t.cur_input,expression:"cur_input"}],staticClass:"wb-tag-input",attrs:{type:"text",placeholder:"输入选项值, 回车确认 *"},domProps:{value:t.cur_input},on:{keyup:t.wbTagInput,input:function(e){e.target.composing||(t.cur_input=e.target.value)}}})])}),r=[],l=(i("ac1f"),i("1276"),i("c975"),i("498a"),i("a15b"),{name:"wbsTags",props:{tags:String,format:String},data:function(){return{cur_input:"",taglist:[],keycode:null}},created:function(){this.taglist=this.tags?this.tags.split(","):[]},methods:{wbTagInput:function(t){var e=this,i=t.keyCode;13===i&&e.wbTagPush()},wbTagPush:function(t){var e=this;return""!=e.cur_input&&(e.taglist.indexOf(e.cur_input.trim())>-1?(e.$wbui.toast("已存在"),e.cur_input="",!1):(e.taglist.push(e.cur_input),e.$emit("set-tags",e.taglist.join(",")),e.cur_input="",!1))},delItem:function(t){var e=this;e.$wbui.confirm("确认删除该选项？",(function(){e.taglist.splice(t,1),e.$emit("set-tags",e.taglist.join(",")),e.$wbui.toast("已移除")}))},displayFormat:function(t){var e=t.split(":");return e.length>1?e[1]+'<em class="wk">(别名:'+e[0]+")</em>":t}},computed:{}}),u=l,c=i("2877"),o=Object(c["a"])(u,n,r,!1,null,null,null),d=o.exports,p={name:"SettingRule",components:{"wbs-tags-module":d},data:function(){var t=this;return{form_changed:0,isLoaded:0,is_pro:t.$cnf.is_pro,spider:{url_type:[]},opt:{user_rule:[],extral_rule:[]},url_type_editing:-1}},created:function(){this.load_data()},methods:{removeRule:function(t){var e=this;e.$wbui.confirm("确认删除？",(function(){e.opt.user_rule.splice(t,1),e.$wbui.toast("已移除")}))},addRule:function(){var t=this;t.opt.user_rule.push({name:"",rule:""}),t.url_type_editing=t.opt.user_rule.length-1},saveRuleItem:function(t){var e=this;return""!=t.name&&""!=t.rule?e.url_type_editing=-1:e.$wbui.toast('请填写完整的"类型"及"规则"'),!1},load_data:function(){var t=this;t.log_loading=t.$wbui.loading(),t.$api.getData({action:t.$cnf.action.act,op:"get_setting",tab:"rule"}).then((function(e){t.$wbui.close(t.log_loading),t.spider.url_type=e["data"]["url_type"],t.opt=e["data"]["opt"],t.isLoaded=1}))},update_data:function(t){var e=this,i={action:e.$cnf.action.act,op:"update_setting",tab:"rule",rule:e.spider.url_type,user_rule:e.opt.user_rule,extral_rule:e.opt.extral_rule};e.$api.saveData(i).then((function(i){e.$wbui.toast("设置保存成功"),e.form_changed=1,t&&t()}))}},watch:{opt:{handler:function(){this.form_changed++},deep:!0}},beforeRouteLeave:function(t,e,i){var a=this;a.form_changed>1?a.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes:function(){return i(!1),a.update_data((function(){i()})),!1},no:function(){return i(),!1}}):i()}},_=p,g=Object(c["a"])(_,a,s,!1,null,null,null);e["default"]=g.exports}}]);